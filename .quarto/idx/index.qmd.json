{"title":"Lab Meeting 20240626 - CLI and OSC","markdown":{"yaml":{"title":"Lab Meeting 20240626 - CLI and OSC","author":"Aaron Max Wiedemer","date":"2024-06-25","categories":["command line","OSC","Unix"],"title-block-banner":false,"number-depth":3,"image":"img/tidy_data_img.jpeg","editor_options":{"chunk_output_type":"console"},"knitr":{"opts_chunk":{"out.width":"85%","class-output":"styled-output"}}},"headingText":"Meeting objectives","containsRefs":false,"markdown":"\n\n--------------------------------------------------------------------------------\n\n<br>\n\n![](img/osc_logo.png){fig-align=\"center\" width=\"70%\"}\n\n<br>\n\n\n\t- Learn how OSC is organized\n\t- Log into OSC on demand and learn how to navigate code server\n\t- Learn some basic UNIX commands\n\t- Learn some best file organization practices within the OSC\n\t- Create your own user directory within our OSC project\n\t\nI'm not sure how far we'll get, but by the end of these lab meetings my goal is to have you introduced to the idea of using software in the command line at OSC\n\t\n::: {.callout-tip title=\"(Re)Sources\" collapse=\"false\"}\n\nMuch of this is based directly on \n\n- [PLNTPTH 6193 - Practical Computing Skills for Omics Data](https://jelmerp.github.io/pracs-sp24/) taught by Jelmer Poelstra (which I _highly_ reccomend) \n- and a little from the COMS 2022 bioinformatics webinar series on HPC which can be found [here](https://www.youtube.com/watch?v=eFqtZsM92a8&list=PLiiqmjBmdWoPynfccwKw_afgfr2UhFUh9&index=3)\n:::\n\n# Intro to High Performance Computing and The Ohio Supercomputer\n\n![](img/owens_HPC_image.png){fig-align=\"center\" width=\"60%\"}\n\n**Supercomputer** (aka a _compute cluster_ or just a _cluster_): a group of __many computers__ connected through a high speed network which can be accessed remotley\n\n\n#### __Why use the OSC?__\n\n- Need more computing power than your own can handles (RAM, CPUs, run time)\n  - e.g., when using large data sets\n- Need to run many analysis\n- Automation of analysis\n\n__Very often useful for Omics data__\n\n#### __OSC Resources__\n\n> -   **<https://ondemand.osc.edu>**: A web portal to use OSC resources through your browser (*login needed*).\n> -   <https://my.osc.edu>: Account and project management (*login needed*).\n> -   <https://osc.edu>: General website with information about the supercomputers, installed software, and usage.\n> \n\n<br>\n\n::: {.callout-tip title=\"Projects\" collapse=false}\n\nAccess to OSC goes through __projects__\n\n\t- Projects can be tied to a lab, class, research project, etc.\n\t- Each project has its own budget in terms of compute hours and storage space\n\t- Users can be part of multiple projects\n\nOur lab's project is __`PAS1640`__\n\n\n:::\n\n## OSC structure\n\n![Example of a Node](img/node_example.png \"Example of a node\"){fig-align=\"center\" width=\"60%\"}\n\n### Words to know when taking about supercomputers\n\n::: {.callout-note title=\"Terms\" collapse=false}\n\n- __Supercomputer__ (aka \"compute cluster\" or just \"cluster): a group of __many computers__ connected through a high speed network \n  - (OSC has 2; \"Owens\" and \"Pitzer\")\n- **Node**: a single computer or server\n- **Core** (aka processor/ CPU): a single unit that runs a set of instructions \n\n:::\n\n## OSC Organization\n\n![OSC Organization Structure](img/osc_organization.png){fig-align=\"center\" width=\"80%\"}\n\n\n \n::: {.callout-note title=\"Parts of OSC\" collapse=false}\n\n- **File Systems**: Where files are stored - this is shared between OSC systems\n- **Login Nodes**: a few \"lower powered\" computers that everyone shares after logging in \n- **Compute Nodes**: The computers used to run analysis (e.g., slurm batch scripts)\n\n:::\n\n### OSC Filing system\n\nMany directories where files are stored, all with different storage, speed, and back-ups\n\n![OSC Filing System](img/osc_file_system.png){fig-align=\"center\" width=\"80%\"}\n\n::: {.callout-note title=\"OSC Filing Systems\" collapse=false}\n\n- **Home** (`/users/`) : These are your files only for you. Is backed up\n- **Project** (`/fs/ess/`) : Shared location for project. Is backed up\n- **Scratch** (`/fs/scratch/`): Stores large input/ output files, is faster than Home or Project. Is NOT backed up.\n\n:::\n\n<br>\n\n# Lets get computing\n\n::: {.callout-important title=\"Everyone go here\" collapse=false}\n\n<https://ondemand.osc.edu>\n\n:::\n\n#### Steps\n\n> 1. log in\n> 2. interactive apps -> servers -> Code Server\n> 3. fill in the following parameters\n\n\n![](img/code_server.png){fig-align=\"center\" width=\"45%\"}\n\n> 4. in code server, select the hamburger menu\n> 5. terminal -> new terminal\n\n\n![](img/new_terminal.png){fig-align=\"center\" width=\"90%\"}\n\n# UNIX crash (bash?) course\n\nOSC uses UNIX (linux like) \n\n::: {.callout-note title=\"Unix shell related terms to know\" collapse=false}\n\n\n\t- **Command line** : the interface where you type commands\n\t- **Terminal** : the program that can run the shell\n\t- **Shell** : The command line interface to your computer (the kernel)\n\t- **Unix shell** : a type of shell that uses unix\n\t- **Bash** : the Unix language that is most common\n\t\n:::\n\n### Unix structure\n\nUnix organization uses a hierarchical directory - often abbreviated to **dir**\n\n- **Root**: the start of the directory (`/`)\n- **Path**: the location of directories\n  - e.g., /fs/ess/PAS1640/aaron/\n  \n![](img/dir_path.png){fig-align=\"center\" width=\"70%\"}\n\n## BASH Commands\n\nInstead of clicking on things to run them such as in a graphical user interface (GUI), command line requires, well, __commands__ to do anything\n\n![anatomy of a command](img/anatomy_of_a_command.png){fig-align=\"center\" width=\"70%\"}\n\nUNIX comes with lots of commands (similar to functions in R or Python), but lets start out slow\n\n### Baby's first command:  `pwd`\n\nLets start with an easy and useful command - `pwd` which prints the working directory\n\nType it into the terminal, press enter and see what happens\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640\n```\n\nEssentially what is happening is we give some input and the output is printed onto the screen which is the default for most UNIX commands\n\n\n### Command with arguments: `cal`\n\nHere is another easy example of a command in CLI - `cal`\n\n```bash\ncal\n```\n``` bash-out\n      June 2024     \nSu Mo Tu We Th Fr Sa\n                   1\n 2  3  4  5  6  7  8\n 9 10 11 12 13 14 15\n16 17 18 19 20 21 22\n23 24 25 26 27 28 29\n30\n```\n\nType in, press enter, get a calendar printed out\n\nBut we can __modify__ what this command does with arguments\n\n\n::: {.callout-note title=\"Arguments\" collapse=false}\n__Arguments__ (also sometimes called flags) come __after a command and are preceded by a dash (-)__ and most often are a single letter\n:::\n\nWith the `-j` argument using `cal` we can get printed the Julian calendar instead\n\n```bash\ncal -j\n```\n```bash-out\n         June 2024         \nSun Mon Tue Wed Thu Fri Sat\n                        153\n154 155 156 157 158 159 160\n161 162 163 164 165 166 167\n168 169 170 171 172 173 174\n175 176 177 178 179 180 181\n182\n```\n\n### Getting help with `-h`\n\nMost commands have multiple arguments, some of which are required for the command to work. We can usually check what a command does and what its arguments are with the `-h` argument\n\nLet's try it with `cal`\n\n```bash\ncal -h\n```\n```bash-out\nUsage:\n cal [options] [[[day] month] year]\n\nOptions:\n -1, --one        show only current month (default)\n -3, --three      show previous, current and next month\n -s, --sunday     Sunday as first day of week\n -m, --monday     Monday as first day of week\n -j, --julian     output Julian dates\n -y, --year       show whole current year\n -V, --version    display version information and exit\n -h, --help       display this help text and exit\n ```\n \n From this we can see `cal` has a lot of different options. Just for funsies lets look at using the `-3` which prints three monts AND the `-j` argument simultainiously\n\nhere, we put the arguments next to each other in any order\n\n```bash\ncal -3 -j\n```\n```bash-out\n          May 2024                    June 2024                    July 2024         \nSun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat\n            122 123 124 125                          153      183 184 185 186 187 188\n126 127 128 129 130 131 132  154 155 156 157 158 159 160  189 190 191 192 193 194 195\n133 134 135 136 137 138 139  161 162 163 164 165 166 167  196 197 198 199 200 201 202\n140 141 142 143 144 145 146  168 169 170 171 172 173 174  203 204 205 206 207 208 209\n147 148 149 150 151 152      175 176 177 178 179 180 181  210 211 212 213            \n                             182  \n ```\n \nArguments can also be passed after the same dash\n\n```bash\ncal -3j\n```\n```bash-out\n          May 2024                    June 2024                    July 2024         \nSun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat\n            122 123 124 125                          153      183 184 185 186 187 188\n126 127 128 129 130 131 132  154 155 156 157 158 159 160  189 190 191 192 193 194 195\n133 134 135 136 137 138 139  161 162 163 164 165 166 167  196 197 198 199 200 201 202\n140 141 142 143 144 145 146  168 169 170 171 172 173 174  203 204 205 206 207 208 209\n147 148 149 150 151 152      175 176 177 178 179 180 181  210 211 212 213            \n                             182  \n ```\n\n::: {.callout-tip title=\"Spell it out\" collapse=\"false\"}\n\nArguments can (but not always) be written out following two preceding dashes (--)\n\ne.g., `-h` can be specified out with `--help`\n\ndepending on the command, it can require the spelled out or the shortened form, but most basic commands should have both available\n\n:::\n\n## Commands I really need you to know\n\n### Commands that do stuff: `cd`\n\nSo far the commands we have used only print something to the screen\n\nMany commands perform some type of action though, such as `cd` which **allows us to change our current working dir**\n\nlets first see where we are again\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640\n```\n\n`cd` takes a dir as an argument and takes us from our current wd to whatever dir we specify\n\nlets use `cd` to get to the auspiciously named `practice_location/`\n\n```bash\ncd practice_location/\n```\n\n::: {.callout-tip title=\"Autocomplete with `tab`\" collapse=\"false\"}\n\ninstead of spelling out the full input everytime, you can use `tab` to autocomplete a line\n\ntry typing `cd p` and then pressing tab to try\n\nIf there are multple dir/ files with the start, double tapping tab will give a list of files that begin with what you have typed so far so you can select which you want to go to\n\n:::\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640/practice_location\n```\n\nand now we can move around!\n\nHere we also used __relative paths__ - because `practice_location` was only one level below, we only had to type out `/practice_location` and not the __absolute__ dir `/fs/ess/PAS1640/practice_location`. It is good to get into the habbit of using relative paths instead of absolute ones in case we move anything around. \n\n\n::: {.callout-note title=\"More on movement\" collapse=\"false\"}\n\nevery dir has a few hidden directories that are useful to get around\n\n- `.` : is the dir of your current dir\n- `..` : is the dir directly above you\n\nto go back a level, use `cd ..`\n\n:::\n\nif we want to go further into the dir, we can spell out the whole dir to get to the `level_3` dir\n\n```bash\ncd level_1/level_2/level_3/\n```\n\nlets check\n\n```bash\npwd\n```\n\nand to get back out, we can use `..`\n\n```bash\ncd ../../../../\n```\n\n### Making directories with `mkdir`\n\n`mkdir` takes a dir as an argument and creates it if one does not already exist\n\n```bash\n# don't run this, its just an example of how you would use it\nmkdir </new_dir>\n```\n::: {.callout-note .callout-warning icon=\"flase\" }\nYou can make multiple subdirectories by adding the `-p` argument to `mkdir`\n\n```bash\n# don't run this, its just an example of how you would use it\nmkdir -p </new_dir/new_subdir/new_sub-subdir>\n```\n:::\n\nfor practice, lets navigate to the `users` folder and make our own folder!\n\n::: {.callout-warning .callout-warning icon=\"flase\" }\n\nGet to the `\\users` dir without me showing you!!\n\n<details>\n\n<summary><b>Solution</b> (click here)</summary>\n\nfrom within `\\PAS1640`\n```bash\ncd \\users\n```\n</details>\n\n:::\n\n#### Making your own dir\n\nWithin the `\\users` dir we can make our own directories!!\n\ncall it whatever you want, but I personally recommend using \n\n```bash\nmkdir $USER\n```\n\n\n\n::: {.callout-tip title=\"A tiny bit on variables\" collapse=\"false\"}\n\nWhile I'm skipping a detailed explanation on variables, I'll quickly mention them here\n\nin UNIX, __variables__ are kept in objects beginning with a dollar sign (`$`)\n\nthere are a few default ones such as \n\n- $HOME : stores the name of the home dir\n- $USER : stores the name of the user\n\nto see what a variable contains, try the `echo` function\n\n```bash\n# this is a general example, don't run it\necho$<VARIABLE>\n```\n\n```bash\necho$USER\n```\n\n:::\n\n### `touch` - update or create\n\n`touch` has a little bit of an odd name for what it is most often used for. \n\nthe primary intended use of `touch` is to \"update the access and modification times of each FILE to the current time\", but in my experince is used more for its secondary function of creating an empty file if one does not already exist.\n\nuse\n\n```bash\n# this is a general example, don't run it\ntouch <file>.<extension>\n```\n\ne.g.,\n\n```bash\ntouch README.md\n```\n\nUse this command to create a README file in your projects as a descriptor of whats there, part of good documentation!!\n\n### `ls` - list, what's in a dir\n\n`ls` can be run on its own to show what is in a dir\n\nuse\n\n```bash\n# don't run this, its just a template example\nls\n```\n\nls also has a bunch of useful arguments to increase its usability which I reccomend checking out, but here are a few I like\n\n::: {.callout-note title=\"important arguments for `ls`\" collapse=\"false\"}\n`-l` : long list formatting (looks better IMO)\n\n`-t` : sorts lists by time, showing the newest first\n\n`-c` : with `-t`, orders by last modified\n\n`-r` : reverses order shown, useful when used alongside `-lt`\n\n`-a`, `--all` : shows all files, including hidden ones\n\nhere's probably the version I use the most\n\n```bash\nls -lt\n```\n:::\n\n\n### `cp` - copy paste\n\n`cp` takes two files as arguments, copying the first to the second\n\ne.g.,\n\n```bash\n# don't run this, its just a template example\ncp </from/> </to/>\n```\n\nusing `cp` on dirs requires the `-r` argument\n\n::: {.callout-note title=\"important arguments for `cp`\" collapse=\"false\"}\n`-r`, `--recursive` : required when copying all contents of a dir from one to another\n:::\n\n### `mv` - move\n\nsimilar to `cp`, `mv` takes two files as arguments, but instead of just coppying, it coppies the file and then deletes the old one\n\nuse\n\n```bash\n# don't run this, its just a template example\nmv </from_old_place/> </to_new_place/>\n```\n\nit again uses the `-r` argument if you want to move a dir containing any number of files or dirs\n\n::: {.callout-note title=\"important arguments for `mv`\" collapse=\"false\"}\n`-r`, `--recursive` : required when moving all contents of a dir from one to another\n:::\n\n### `rm` - remove\n\nas the name implies, using `rm` removes a file. This can be a dangerous function as files are not always backed up, so use with caution!\n\nTo remove a dir we again need to use the `-r` argument\n\n::: {.callout-note title=\"important arguments for `rm``\" collapse=\"false\"}\n`-r`, `--recursive` : required when removing all contents of a dir\n\n`-i` : requires a prompt to remove a file, makes it much safer\n\n`-f`, `-force` : forces a remove, be careful when using this\n:::\n\n\n### `chmod` - change file permissions\n\n`chmod` allows you to change file permission access for file owner (user, `u`), “group” (`g`), others (`o`) or everyone (all; `a`). Permissions can be set for reading (`r`), writing (`w`), and executing (`x`).\n\n`chmod` takes a user (either file owner(`u`), group(`g`), or everyone(`a`)) and __adds__ or __subtracts__ permissions for a given file\n\nuse\n\n```bash\n# don't run this, its just a template example\nchmod <user> < + or - > <permission> <file>\n```\n\ne.g.,\n\n```bash\n# don't run these, they are just examples of use cases\n\n# this will make a script executable for the file owner\nchmod u+x script.sh\n\n# this will make data read only\nchmod a=r data/raw/*\n```\n\nlets take a look at what the file permissions look like for the PAS1640 home dir\n\n```bash\ncd /fs/ess/PAS1640\n\nls -lt\n```\n```bash-out\ntotal 20\ndrwxr-xr-x  3 awiedemer673 PAS1640  4096 Jun 25 01:38 users\ndrwxr-xr-x  3 awiedemer673 PAS1640  4096 Jun 25 01:26 practice_location\ndrwxr-xr-x  3 msholola     PAS0471  4096 Apr 17 20:34 maria\ndrwxr-xr-x 12 msholola     PAS0471 16384 Mar 22 10:55 plasma_transcriptomics\ndrwxr-xr-x  4 cooperstone  PAS1542  4096 Mar 14 13:51 jess\ndrwxr-xr-x  6 quiroz1      PAS1640  4096 Jun  2  2023 instrument_files\ndrwxr-xr-x  7 quiroz1      PAS1640  4096 May 13  2023 Apples_DIA\ndrwxr-xr-x  3 quiroz1      PAS1640  4096 Jun  6  2022 Apples_neg\n```\n\nthe string of seemingly random letters and dashes denotes file permissions (e.g., drwxr-xr-x)\n\n![](img/file_permissions.png){fig-align=\"center\" width=\"60%\"}\n\n# Project and File organization best practices\n\nGood organization facilitates\n\n\t- Collaboration\n\t- Reproducibility\n\t- Automation\n\t- Version Control\n\t- General chaos prevention\n\n\n## Some quick best practices\n\n### Use one dir per preject!\n\n![](img/project_org.png){fig-align=\"center\" width=\"70%\"}\n\n#### Separate different kinds of files using a consistent dir structure\n\nSeparate\n\n- __Raw data__ (treat as __read-only__, don’t wanna directly mess with it - use `chmod a=r data/raw/*`)\n- __Scripts__\n- __Outputs__ (results) (treat as disposable and possible to regenerate - make outputs __reproducable__)\n\n\n### Use relative paths whenever able\n\n![](img/rel_path.png){fig-align=\"center\" width=\"70%\"}\n\nif you use `mv` the absolute path changes, but not necessarily relative paths\n\n> again, `.` is where you are, `..` signifies the path one up in the hierarchy\n\n\n### File naming\n\n3 good principals for file naming \n\n\t- Machine readable\n\t- Human readable\n\t- Ordered in a consistent way\n\n#### Machine readable\n\n\nIn file names provide metadata such as sample ID, date, treatment separated by underscores (_)\n\ne.g.,\n\n\t- astro_30S_har2_rep1.csv\n\t- rariety_treatment_replicate\n\n```bash\nls astro*\n```\n```bash-out\nastro_00S_har1_rep1.csv\nastro_10S_har1_rep1.csv\nastro_20S_har1_rep1.csv\nastro_30S_har1_rep1.csv\netc...\n```\n\n```bash\nls *har2*\n```\n```bash-out\nastro_00S_har2_rep1\nesme_10S_har2_rep2\netc...\n```\n\n#### Combining machine and human readability\n\n\n\t- Use underscores (_) to separate distinct units (sample name, metadata)\n\t- If you must separate words, use dashes (-) (i.e., wild-type)\n\t- Limit period use (.) to file extensions (eg., .txt, .csv)\n\t- (generally) __Never use spaces__\n\n#### Default ordering\n\n\t- Use leading zeros when ordering numbers (005, 099)\n\t- Dates should be YYYY-MM-DD\n\t- Group similar files together by using the same phrase and number scripts by extension order \n\t\ne.g.,\n\n```bash\nAP-01_normalize.R\nAP-02_log-transform.R\nAP-03_test-sig.R\n```\n\n### Document everying\n\n__Use a README.md file to explain whats in what__\n\n","srcMarkdownNoYaml":"\n\n--------------------------------------------------------------------------------\n\n<br>\n\n![](img/osc_logo.png){fig-align=\"center\" width=\"70%\"}\n\n<br>\n\n## Meeting objectives\n\n\t- Learn how OSC is organized\n\t- Log into OSC on demand and learn how to navigate code server\n\t- Learn some basic UNIX commands\n\t- Learn some best file organization practices within the OSC\n\t- Create your own user directory within our OSC project\n\t\nI'm not sure how far we'll get, but by the end of these lab meetings my goal is to have you introduced to the idea of using software in the command line at OSC\n\t\n::: {.callout-tip title=\"(Re)Sources\" collapse=\"false\"}\n\nMuch of this is based directly on \n\n- [PLNTPTH 6193 - Practical Computing Skills for Omics Data](https://jelmerp.github.io/pracs-sp24/) taught by Jelmer Poelstra (which I _highly_ reccomend) \n- and a little from the COMS 2022 bioinformatics webinar series on HPC which can be found [here](https://www.youtube.com/watch?v=eFqtZsM92a8&list=PLiiqmjBmdWoPynfccwKw_afgfr2UhFUh9&index=3)\n:::\n\n# Intro to High Performance Computing and The Ohio Supercomputer\n\n![](img/owens_HPC_image.png){fig-align=\"center\" width=\"60%\"}\n\n**Supercomputer** (aka a _compute cluster_ or just a _cluster_): a group of __many computers__ connected through a high speed network which can be accessed remotley\n\n\n#### __Why use the OSC?__\n\n- Need more computing power than your own can handles (RAM, CPUs, run time)\n  - e.g., when using large data sets\n- Need to run many analysis\n- Automation of analysis\n\n__Very often useful for Omics data__\n\n#### __OSC Resources__\n\n> -   **<https://ondemand.osc.edu>**: A web portal to use OSC resources through your browser (*login needed*).\n> -   <https://my.osc.edu>: Account and project management (*login needed*).\n> -   <https://osc.edu>: General website with information about the supercomputers, installed software, and usage.\n> \n\n<br>\n\n::: {.callout-tip title=\"Projects\" collapse=false}\n\nAccess to OSC goes through __projects__\n\n\t- Projects can be tied to a lab, class, research project, etc.\n\t- Each project has its own budget in terms of compute hours and storage space\n\t- Users can be part of multiple projects\n\nOur lab's project is __`PAS1640`__\n\n\n:::\n\n## OSC structure\n\n![Example of a Node](img/node_example.png \"Example of a node\"){fig-align=\"center\" width=\"60%\"}\n\n### Words to know when taking about supercomputers\n\n::: {.callout-note title=\"Terms\" collapse=false}\n\n- __Supercomputer__ (aka \"compute cluster\" or just \"cluster): a group of __many computers__ connected through a high speed network \n  - (OSC has 2; \"Owens\" and \"Pitzer\")\n- **Node**: a single computer or server\n- **Core** (aka processor/ CPU): a single unit that runs a set of instructions \n\n:::\n\n## OSC Organization\n\n![OSC Organization Structure](img/osc_organization.png){fig-align=\"center\" width=\"80%\"}\n\n\n \n::: {.callout-note title=\"Parts of OSC\" collapse=false}\n\n- **File Systems**: Where files are stored - this is shared between OSC systems\n- **Login Nodes**: a few \"lower powered\" computers that everyone shares after logging in \n- **Compute Nodes**: The computers used to run analysis (e.g., slurm batch scripts)\n\n:::\n\n### OSC Filing system\n\nMany directories where files are stored, all with different storage, speed, and back-ups\n\n![OSC Filing System](img/osc_file_system.png){fig-align=\"center\" width=\"80%\"}\n\n::: {.callout-note title=\"OSC Filing Systems\" collapse=false}\n\n- **Home** (`/users/`) : These are your files only for you. Is backed up\n- **Project** (`/fs/ess/`) : Shared location for project. Is backed up\n- **Scratch** (`/fs/scratch/`): Stores large input/ output files, is faster than Home or Project. Is NOT backed up.\n\n:::\n\n<br>\n\n# Lets get computing\n\n::: {.callout-important title=\"Everyone go here\" collapse=false}\n\n<https://ondemand.osc.edu>\n\n:::\n\n#### Steps\n\n> 1. log in\n> 2. interactive apps -> servers -> Code Server\n> 3. fill in the following parameters\n\n\n![](img/code_server.png){fig-align=\"center\" width=\"45%\"}\n\n> 4. in code server, select the hamburger menu\n> 5. terminal -> new terminal\n\n\n![](img/new_terminal.png){fig-align=\"center\" width=\"90%\"}\n\n# UNIX crash (bash?) course\n\nOSC uses UNIX (linux like) \n\n::: {.callout-note title=\"Unix shell related terms to know\" collapse=false}\n\n\n\t- **Command line** : the interface where you type commands\n\t- **Terminal** : the program that can run the shell\n\t- **Shell** : The command line interface to your computer (the kernel)\n\t- **Unix shell** : a type of shell that uses unix\n\t- **Bash** : the Unix language that is most common\n\t\n:::\n\n### Unix structure\n\nUnix organization uses a hierarchical directory - often abbreviated to **dir**\n\n- **Root**: the start of the directory (`/`)\n- **Path**: the location of directories\n  - e.g., /fs/ess/PAS1640/aaron/\n  \n![](img/dir_path.png){fig-align=\"center\" width=\"70%\"}\n\n## BASH Commands\n\nInstead of clicking on things to run them such as in a graphical user interface (GUI), command line requires, well, __commands__ to do anything\n\n![anatomy of a command](img/anatomy_of_a_command.png){fig-align=\"center\" width=\"70%\"}\n\nUNIX comes with lots of commands (similar to functions in R or Python), but lets start out slow\n\n### Baby's first command:  `pwd`\n\nLets start with an easy and useful command - `pwd` which prints the working directory\n\nType it into the terminal, press enter and see what happens\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640\n```\n\nEssentially what is happening is we give some input and the output is printed onto the screen which is the default for most UNIX commands\n\n\n### Command with arguments: `cal`\n\nHere is another easy example of a command in CLI - `cal`\n\n```bash\ncal\n```\n``` bash-out\n      June 2024     \nSu Mo Tu We Th Fr Sa\n                   1\n 2  3  4  5  6  7  8\n 9 10 11 12 13 14 15\n16 17 18 19 20 21 22\n23 24 25 26 27 28 29\n30\n```\n\nType in, press enter, get a calendar printed out\n\nBut we can __modify__ what this command does with arguments\n\n\n::: {.callout-note title=\"Arguments\" collapse=false}\n__Arguments__ (also sometimes called flags) come __after a command and are preceded by a dash (-)__ and most often are a single letter\n:::\n\nWith the `-j` argument using `cal` we can get printed the Julian calendar instead\n\n```bash\ncal -j\n```\n```bash-out\n         June 2024         \nSun Mon Tue Wed Thu Fri Sat\n                        153\n154 155 156 157 158 159 160\n161 162 163 164 165 166 167\n168 169 170 171 172 173 174\n175 176 177 178 179 180 181\n182\n```\n\n### Getting help with `-h`\n\nMost commands have multiple arguments, some of which are required for the command to work. We can usually check what a command does and what its arguments are with the `-h` argument\n\nLet's try it with `cal`\n\n```bash\ncal -h\n```\n```bash-out\nUsage:\n cal [options] [[[day] month] year]\n\nOptions:\n -1, --one        show only current month (default)\n -3, --three      show previous, current and next month\n -s, --sunday     Sunday as first day of week\n -m, --monday     Monday as first day of week\n -j, --julian     output Julian dates\n -y, --year       show whole current year\n -V, --version    display version information and exit\n -h, --help       display this help text and exit\n ```\n \n From this we can see `cal` has a lot of different options. Just for funsies lets look at using the `-3` which prints three monts AND the `-j` argument simultainiously\n\nhere, we put the arguments next to each other in any order\n\n```bash\ncal -3 -j\n```\n```bash-out\n          May 2024                    June 2024                    July 2024         \nSun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat\n            122 123 124 125                          153      183 184 185 186 187 188\n126 127 128 129 130 131 132  154 155 156 157 158 159 160  189 190 191 192 193 194 195\n133 134 135 136 137 138 139  161 162 163 164 165 166 167  196 197 198 199 200 201 202\n140 141 142 143 144 145 146  168 169 170 171 172 173 174  203 204 205 206 207 208 209\n147 148 149 150 151 152      175 176 177 178 179 180 181  210 211 212 213            \n                             182  \n ```\n \nArguments can also be passed after the same dash\n\n```bash\ncal -3j\n```\n```bash-out\n          May 2024                    June 2024                    July 2024         \nSun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat  Sun Mon Tue Wed Thu Fri Sat\n            122 123 124 125                          153      183 184 185 186 187 188\n126 127 128 129 130 131 132  154 155 156 157 158 159 160  189 190 191 192 193 194 195\n133 134 135 136 137 138 139  161 162 163 164 165 166 167  196 197 198 199 200 201 202\n140 141 142 143 144 145 146  168 169 170 171 172 173 174  203 204 205 206 207 208 209\n147 148 149 150 151 152      175 176 177 178 179 180 181  210 211 212 213            \n                             182  \n ```\n\n::: {.callout-tip title=\"Spell it out\" collapse=\"false\"}\n\nArguments can (but not always) be written out following two preceding dashes (--)\n\ne.g., `-h` can be specified out with `--help`\n\ndepending on the command, it can require the spelled out or the shortened form, but most basic commands should have both available\n\n:::\n\n## Commands I really need you to know\n\n### Commands that do stuff: `cd`\n\nSo far the commands we have used only print something to the screen\n\nMany commands perform some type of action though, such as `cd` which **allows us to change our current working dir**\n\nlets first see where we are again\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640\n```\n\n`cd` takes a dir as an argument and takes us from our current wd to whatever dir we specify\n\nlets use `cd` to get to the auspiciously named `practice_location/`\n\n```bash\ncd practice_location/\n```\n\n::: {.callout-tip title=\"Autocomplete with `tab`\" collapse=\"false\"}\n\ninstead of spelling out the full input everytime, you can use `tab` to autocomplete a line\n\ntry typing `cd p` and then pressing tab to try\n\nIf there are multple dir/ files with the start, double tapping tab will give a list of files that begin with what you have typed so far so you can select which you want to go to\n\n:::\n\n```bash\npwd\n```\n```bash-out\n/fs/ess/PAS1640/practice_location\n```\n\nand now we can move around!\n\nHere we also used __relative paths__ - because `practice_location` was only one level below, we only had to type out `/practice_location` and not the __absolute__ dir `/fs/ess/PAS1640/practice_location`. It is good to get into the habbit of using relative paths instead of absolute ones in case we move anything around. \n\n\n::: {.callout-note title=\"More on movement\" collapse=\"false\"}\n\nevery dir has a few hidden directories that are useful to get around\n\n- `.` : is the dir of your current dir\n- `..` : is the dir directly above you\n\nto go back a level, use `cd ..`\n\n:::\n\nif we want to go further into the dir, we can spell out the whole dir to get to the `level_3` dir\n\n```bash\ncd level_1/level_2/level_3/\n```\n\nlets check\n\n```bash\npwd\n```\n\nand to get back out, we can use `..`\n\n```bash\ncd ../../../../\n```\n\n### Making directories with `mkdir`\n\n`mkdir` takes a dir as an argument and creates it if one does not already exist\n\n```bash\n# don't run this, its just an example of how you would use it\nmkdir </new_dir>\n```\n::: {.callout-note .callout-warning icon=\"flase\" }\nYou can make multiple subdirectories by adding the `-p` argument to `mkdir`\n\n```bash\n# don't run this, its just an example of how you would use it\nmkdir -p </new_dir/new_subdir/new_sub-subdir>\n```\n:::\n\nfor practice, lets navigate to the `users` folder and make our own folder!\n\n::: {.callout-warning .callout-warning icon=\"flase\" }\n\nGet to the `\\users` dir without me showing you!!\n\n<details>\n\n<summary><b>Solution</b> (click here)</summary>\n\nfrom within `\\PAS1640`\n```bash\ncd \\users\n```\n</details>\n\n:::\n\n#### Making your own dir\n\nWithin the `\\users` dir we can make our own directories!!\n\ncall it whatever you want, but I personally recommend using \n\n```bash\nmkdir $USER\n```\n\n\n\n::: {.callout-tip title=\"A tiny bit on variables\" collapse=\"false\"}\n\nWhile I'm skipping a detailed explanation on variables, I'll quickly mention them here\n\nin UNIX, __variables__ are kept in objects beginning with a dollar sign (`$`)\n\nthere are a few default ones such as \n\n- $HOME : stores the name of the home dir\n- $USER : stores the name of the user\n\nto see what a variable contains, try the `echo` function\n\n```bash\n# this is a general example, don't run it\necho$<VARIABLE>\n```\n\n```bash\necho$USER\n```\n\n:::\n\n### `touch` - update or create\n\n`touch` has a little bit of an odd name for what it is most often used for. \n\nthe primary intended use of `touch` is to \"update the access and modification times of each FILE to the current time\", but in my experince is used more for its secondary function of creating an empty file if one does not already exist.\n\nuse\n\n```bash\n# this is a general example, don't run it\ntouch <file>.<extension>\n```\n\ne.g.,\n\n```bash\ntouch README.md\n```\n\nUse this command to create a README file in your projects as a descriptor of whats there, part of good documentation!!\n\n### `ls` - list, what's in a dir\n\n`ls` can be run on its own to show what is in a dir\n\nuse\n\n```bash\n# don't run this, its just a template example\nls\n```\n\nls also has a bunch of useful arguments to increase its usability which I reccomend checking out, but here are a few I like\n\n::: {.callout-note title=\"important arguments for `ls`\" collapse=\"false\"}\n`-l` : long list formatting (looks better IMO)\n\n`-t` : sorts lists by time, showing the newest first\n\n`-c` : with `-t`, orders by last modified\n\n`-r` : reverses order shown, useful when used alongside `-lt`\n\n`-a`, `--all` : shows all files, including hidden ones\n\nhere's probably the version I use the most\n\n```bash\nls -lt\n```\n:::\n\n\n### `cp` - copy paste\n\n`cp` takes two files as arguments, copying the first to the second\n\ne.g.,\n\n```bash\n# don't run this, its just a template example\ncp </from/> </to/>\n```\n\nusing `cp` on dirs requires the `-r` argument\n\n::: {.callout-note title=\"important arguments for `cp`\" collapse=\"false\"}\n`-r`, `--recursive` : required when copying all contents of a dir from one to another\n:::\n\n### `mv` - move\n\nsimilar to `cp`, `mv` takes two files as arguments, but instead of just coppying, it coppies the file and then deletes the old one\n\nuse\n\n```bash\n# don't run this, its just a template example\nmv </from_old_place/> </to_new_place/>\n```\n\nit again uses the `-r` argument if you want to move a dir containing any number of files or dirs\n\n::: {.callout-note title=\"important arguments for `mv`\" collapse=\"false\"}\n`-r`, `--recursive` : required when moving all contents of a dir from one to another\n:::\n\n### `rm` - remove\n\nas the name implies, using `rm` removes a file. This can be a dangerous function as files are not always backed up, so use with caution!\n\nTo remove a dir we again need to use the `-r` argument\n\n::: {.callout-note title=\"important arguments for `rm``\" collapse=\"false\"}\n`-r`, `--recursive` : required when removing all contents of a dir\n\n`-i` : requires a prompt to remove a file, makes it much safer\n\n`-f`, `-force` : forces a remove, be careful when using this\n:::\n\n\n### `chmod` - change file permissions\n\n`chmod` allows you to change file permission access for file owner (user, `u`), “group” (`g`), others (`o`) or everyone (all; `a`). Permissions can be set for reading (`r`), writing (`w`), and executing (`x`).\n\n`chmod` takes a user (either file owner(`u`), group(`g`), or everyone(`a`)) and __adds__ or __subtracts__ permissions for a given file\n\nuse\n\n```bash\n# don't run this, its just a template example\nchmod <user> < + or - > <permission> <file>\n```\n\ne.g.,\n\n```bash\n# don't run these, they are just examples of use cases\n\n# this will make a script executable for the file owner\nchmod u+x script.sh\n\n# this will make data read only\nchmod a=r data/raw/*\n```\n\nlets take a look at what the file permissions look like for the PAS1640 home dir\n\n```bash\ncd /fs/ess/PAS1640\n\nls -lt\n```\n```bash-out\ntotal 20\ndrwxr-xr-x  3 awiedemer673 PAS1640  4096 Jun 25 01:38 users\ndrwxr-xr-x  3 awiedemer673 PAS1640  4096 Jun 25 01:26 practice_location\ndrwxr-xr-x  3 msholola     PAS0471  4096 Apr 17 20:34 maria\ndrwxr-xr-x 12 msholola     PAS0471 16384 Mar 22 10:55 plasma_transcriptomics\ndrwxr-xr-x  4 cooperstone  PAS1542  4096 Mar 14 13:51 jess\ndrwxr-xr-x  6 quiroz1      PAS1640  4096 Jun  2  2023 instrument_files\ndrwxr-xr-x  7 quiroz1      PAS1640  4096 May 13  2023 Apples_DIA\ndrwxr-xr-x  3 quiroz1      PAS1640  4096 Jun  6  2022 Apples_neg\n```\n\nthe string of seemingly random letters and dashes denotes file permissions (e.g., drwxr-xr-x)\n\n![](img/file_permissions.png){fig-align=\"center\" width=\"60%\"}\n\n# Project and File organization best practices\n\nGood organization facilitates\n\n\t- Collaboration\n\t- Reproducibility\n\t- Automation\n\t- Version Control\n\t- General chaos prevention\n\n\n## Some quick best practices\n\n### Use one dir per preject!\n\n![](img/project_org.png){fig-align=\"center\" width=\"70%\"}\n\n#### Separate different kinds of files using a consistent dir structure\n\nSeparate\n\n- __Raw data__ (treat as __read-only__, don’t wanna directly mess with it - use `chmod a=r data/raw/*`)\n- __Scripts__\n- __Outputs__ (results) (treat as disposable and possible to regenerate - make outputs __reproducable__)\n\n\n### Use relative paths whenever able\n\n![](img/rel_path.png){fig-align=\"center\" width=\"70%\"}\n\nif you use `mv` the absolute path changes, but not necessarily relative paths\n\n> again, `.` is where you are, `..` signifies the path one up in the hierarchy\n\n\n### File naming\n\n3 good principals for file naming \n\n\t- Machine readable\n\t- Human readable\n\t- Ordered in a consistent way\n\n#### Machine readable\n\n\nIn file names provide metadata such as sample ID, date, treatment separated by underscores (_)\n\ne.g.,\n\n\t- astro_30S_har2_rep1.csv\n\t- rariety_treatment_replicate\n\n```bash\nls astro*\n```\n```bash-out\nastro_00S_har1_rep1.csv\nastro_10S_har1_rep1.csv\nastro_20S_har1_rep1.csv\nastro_30S_har1_rep1.csv\netc...\n```\n\n```bash\nls *har2*\n```\n```bash-out\nastro_00S_har2_rep1\nesme_10S_har2_rep2\netc...\n```\n\n#### Combining machine and human readability\n\n\n\t- Use underscores (_) to separate distinct units (sample name, metadata)\n\t- If you must separate words, use dashes (-) (i.e., wild-type)\n\t- Limit period use (.) to file extensions (eg., .txt, .csv)\n\t- (generally) __Never use spaces__\n\n#### Default ordering\n\n\t- Use leading zeros when ordering numbers (005, 099)\n\t- Dates should be YYYY-MM-DD\n\t- Group similar files together by using the same phrase and number scripts by extension order \n\t\ne.g.,\n\n```bash\nAP-01_normalize.R\nAP-02_log-transform.R\nAP-03_test-sig.R\n```\n\n### Document everying\n\n__Use a README.md file to explain whats in what__\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","theme":"cosmo","title":"Lab Meeting 20240626 - CLI and OSC","author":"Aaron Max Wiedemer","date":"2024-06-25","categories":["command line","OSC","Unix"],"title-block-banner":false,"number-depth":3,"image":"img/tidy_data_img.jpeg","editor_options":{"chunk_output_type":"console"},"knitr":{"opts_chunk":{"out.width":"85%","class-output":"styled-output"}}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}